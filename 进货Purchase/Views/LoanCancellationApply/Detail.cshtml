@{
    Layout = "~/Views/Shared/_Index.cshtml";
}
<style>
    .down1 {
        position: absolute;
        right:10px;
        width: 20px;
        font-size: 3.5em;
        color: #FFFFFF;
        cursor: pointer;
    }

    .helpinfo {
        width: 450px;
        list-style: none;
        position: absolute;
        top: 20px;
        right: 60px;
        background: #fff;
        border: 1px solid #000;
        border-radius: 5px;
    }

        .helpinfo li {
            width: 200px;
            color: red;
        }

    .tile-body {
        position: relative;
        max-height: 30px;
        overflow: hidden;
    }

    .tile-body1 {
        max-height: 65px;
        overflow: auto;
    }


    .more {
        position: absolute;
        right: 20px;
        top: 8px;
        cursor: pointer;
    }

    #searchForm2 {
        width: 95%;
        float: left;
        position: relative;
    }

    .head_bg th {
        border-right: 1px solid #ddd;
    }

    .form-group {
        margin-right: 5px;
        margin-bottom: 5px !important;
    }
     .dataTables_scroll {
        position: relative;
    }
    #orderForm {
        margin-bottom:35px;
    }
    .dataTables_scrollFoot {
        position: absolute;
        bottom: 15px;
    }
    table.dataTable tfoot th, table.dataTable tfoot td {
        border-top:none;
    }
</style>

<div id="apps" class="pt-5 pl-5 pr-5">
    <div class="row m-0">
        <div class="col-md-12 row-tit p-0  mb-5">
            <div id="T_Menu_Alias" class="col-md-2 col-sm-2 p-tit">借出取消申请制单</div>
            <div class="col-md-10 col-sm-10 p-btn pr-40">
                <erp-button v-bind:btn_cb="Save" v_id="btnSave" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b" fa_icon="fa fa-save">保存</erp-button>
                <erp-button v-bind:btn_cb="Update" v_id="btnUpdate" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b" fa_icon="fa fa-edit">修改</erp-button>
                <erp-button v-bind:btn_cb="Submit" v_id="btnSubmit" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b" fa_icon="fa fa-check">提交</erp-button>
                <erp-button v-bind:btn_cb="Audit" v_id="btnAudit" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b" fa_icon="fa fa-check-circle">审核</erp-button>
                <erp-button v-bind:btn_cb="Back" v_id="btnBack" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b" fa_icon="fa fa-mail-reply">返回</erp-button>
                <div class="btn-group" role="group">
                    <button type="button" class="btn-primary btn-rounded btn-sm btn-ef" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        其他
                        <span class="caret"></span>
                    </button>
                    <ul class="dropdown-menu" style="width:100px;">
                        <li><a href="#">统计</a></li>
                        <li><a href="#">审批意见</a></li>
                    </ul>
                </div>
            </div>
            <div class="down1"><i class="fa fa-angle-double-down"></i></div>
        </div>
        <div class="col-md-12 col-sm-12 pl-5 pr-5">
            <div class="tile-body clearfix">
                <form class="form-inline" id="searchForm2">
                    <div class="more">更多 <i class="fa fa-angle-double-down"></i></div>
                    <div id="order_4" class="form-group show-order">
                        <erp-text v_id="Menu">取消单号:</erp-text>
                    </div>
                    <div id="order_1" class="form-group show-order">
                        <erp-datedb v_id="Menu_Address" v-model="Menu_Address">制单日期:</erp-datedb>
                    </div>
                    <div id="order_3" class="form-group show-order">
                        <erp-textarea v-model="cancelReason" v_id="t2">取消原因:</erp-textarea>
                    </div>
                </form>
                <div class="submitSearch">
                    <erp-button v-bind:btn_cb="Search" v_id="btnSearch" fa_icon="fa fa-search" btn_type="btn-primary btn-rounded btn-ef btn-sm btn-ef-5 btn-ef-5b">查询</erp-button>
                </div>
            </div>
        </div>
        <div class="col-md-12 col-sm-12 p-0">
            @*<erp-table  childlistid="OrderFormDetailList" pageing="true" v-bind:childsearchkey="childSearchModel" showchild="true"  multiselect="false" showcheckbox="true" v-bind:searchmodel="searchModel" v_id="OrderFormList" v-bind:tableurl="tableUrl" v-bind:columheaderseach="columHeaderSeach"></erp-table>*@
            <div id="div_table_orderForm" class="table">
                <table id="orderForm" style="float: left;" class="display cell-border" cellspacing="0" width="100%">
                    <thead class="head_bg">
                        <tr>
                            <th class="td_Align_center sorting_disabled" style="width:0px;" aria-label="行号"><p class="btn-md"><i class="fa fa-gear" style="display:block;font-size: 15px;"></i></p></th>
                            <th>操作</th>
                            <th>型号规格</th>
                            <th>品名</th>
                            <th>计量单位</th>
                            <th>油纸包装</th>
                            <th>品牌</th>
                            <th>产地</th>
                            <th>取消数量</th>
                            <th>库房名称</th>
                            <th>货位</th>
                            <th>单据来源</th>
                            <th>借出单号</th>
                            <th>客户名称</th>
                            <th>借出人</th>
                            <th>部门</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="td_Align_center">1</td>
                            <td style="text-align:center;"><span class="add mr-15" href="#"><i class="glyphicon glyphicon-plus"></i></span><span class="deletes"><i class="glyphicon glyphicon-minus"></i></span></td>
                            <td style="text-align:center !important;">22215EAE4C3 </td>
                            <td style="text-align:center !important;">轴承</td>
                            <td style="text-align:center !important;">套</td>
                            <td style="text-align:center !important;">油纸</td>
                            <td style="text-align:center !important;">品牌一</td>
                            <td style="text-align:center !important;">上海</td>
                            <td style="text-align:center !important;">20</td>
                            <td style="text-align:center !important;">上海库房</td>
                            <td style="text-align:center !important;">3</td>
                            <td style="text-align:center !important;">导入</td>
                            <td style="text-align:center !important;">21455121542ds</td>
                            <td style="text-align:center !important;">客户1</td>
                            <td style="text-align:center !important;">小王</td>
                            <td style="text-align:center !important;">销售</td>
                        </tr>
                        <tr>
                            <td class="td_Align_center">2</td>
                            <td style="text-align:center;"><span class="add mr-15" href="#"><i class="glyphicon glyphicon-plus"></i></span><span class="deletes"><i class="glyphicon glyphicon-minus"></i></span></td>
                            <td style="text-align:center !important;">22215EAE4C3 </td>
                            <td style="text-align:center !important;">轴承</td>
                            <td style="text-align:center !important;">套</td>
                            <td style="text-align:center !important;">油纸</td>
                            <td style="text-align:center !important;">品牌一</td>
                            <td style="text-align:center !important;">上海</td>
                            <td style="text-align:center !important;">20</td>
                            <td style="text-align:center !important;">上海库房</td>
                            <td style="text-align:center !important;">3</td>
                            <td style="text-align:center !important;">导入</td>
                            <td style="text-align:center !important;">21455121542ds</td>
                            <td style="text-align:center !important;">客户1</td>
                            <td style="text-align:center !important;">小王</td>
                            <td style="text-align:center !important;">销售</td>
                        </tr>
                        <tr>
                            <td class="td_Align_center">3</td>
                            <td style="text-align:center;"><span class="add mr-15" href="#"><i class="glyphicon glyphicon-plus"></i></span><span class="deletes"><i class="glyphicon glyphicon-minus"></i></span></td>
                            <td style="text-align:center !important;">22215EAE4C3 </td>
                            <td style="text-align:center !important;">轴承</td>
                            <td style="text-align:center !important;">套</td>
                            <td style="text-align:center !important;">油纸</td>
                            <td style="text-align:center !important;">品牌一</td>
                            <td style="text-align:center !important;">上海</td>
                            <td style="text-align:center !important;">20</td>
                            <td style="text-align:center !important;">上海库房</td>
                            <td style="text-align:center !important;">3</td>
                            <td style="text-align:center !important;">导入</td>
                            <td style="text-align:center !important;">21455121542ds</td>
                            <td style="text-align:center !important;">客户1</td>
                            <td style="text-align:center !important;">小王</td>
                            <td style="text-align:center !important;">销售</td>
                        </tr>
                        <tr>
                            <td class="td_Align_center">4</td>
                            <td style="text-align:center;"><span class="add mr-15" href="#"><i class="glyphicon glyphicon-plus"></i></span><span class="deletes"><i class="glyphicon glyphicon-minus"></i></span></td>
                            <td style="text-align:center !important;">22215EAE4C3 </td>
                            <td style="text-align:center !important;">轴承</td>
                            <td style="text-align:center !important;">套</td>
                            <td style="text-align:center !important;">油纸</td>
                            <td style="text-align:center !important;">品牌一</td>
                            <td style="text-align:center !important;">上海</td>
                            <td style="text-align:center !important;">20</td>
                            <td style="text-align:center !important;">上海库房</td>
                            <td style="text-align:center !important;">3</td>
                            <td style="text-align:center !important;">导入</td>
                            <td style="text-align:center !important;">21455121542ds</td>
                            <td style="text-align:center !important;">客户1</td>
                            <td style="text-align:center !important;">小王</td>
                            <td style="text-align:center !important;">销售</td>
                        </tr>
                    </tbody>
                    @*<tfoot>
                            <tr>
                                <th style="text-align:right !important;">合计:</th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                        </tfoot>*@
                </table>
            </div>
        </div>
    </div>
</div>
<script type="text/x-handlebars-template" id="temp_a6">
    <div id="div_temp_a6">
        <erp-text v-model="vmodel1" v_id="a6" CheckLength="200"></erp-text>
    </div>
</script>
<script>
    $(document).ready(function () {
        $(".more").click(function () {
            $(this).find("i").toggleClass('rotate');
            $(".tile-body").toggleClass("tile-body1");
            $(".dataTables_scrollBody").height($(window).outerHeight() - $(".dataTables_scrollBody").offset().top - $(".tableBottom").outerHeight() - 20 - $(".dataTables_scrollFoot").outerHeight());

            var tableid = $(".dataTables_scrollBody").find("table").attr("id")
            PageCommon.RefreshTablePage(tableid)
        })
        $(".down1").click(function () {
            $(".tile-body").toggle();
            $(this).find("i").toggleClass('rotate');
            $("#div_table_orderForm .dataTables_scrollBody").height($(window).outerHeight() - $("#div_table_orderForm .dataTables_scrollBody").offset().top - $("#div_table_orderForm .tableBottom").outerHeight() - 10);
            $("#div_table_orderForm3 .dataTables_scrollBody").height($(window).outerHeight() - $("#div_table_orderForm3 .dataTables_scrollBody").offset().top - $("#div_table_orderForm3 .tableBottom").outerHeight() - 10);
            PageCommon.RefreshTablePage("orderForm");
            PageCommon.RefreshTablePage("orderForm3");
        })
        $("#provider,#typeSpecification,#brand,#place,#prepared,#tm,#department").select2({
            placeholder: "请选择",
            minimumResultsForSearch: -1,
            templateSelection: function formatRepoSelection(repo) {
                $("#provider,#typeSpecification,#brand,#place,#prepared,#tm,#department").val("");
                return $(repo.element).attr("value");
            }
        });

        $("#paymentWay,#bills,#currency,#searchnum,#apping").select2({
            placeholder: "请选择",
            allowClear: true,//删除x图标
            minimumResultsForSearch: Infinity
        });
        var tw = $("#div_table_orderForm").width();
        var table = $('#orderForm').DataTable({
            "select": true,
            "autoWidth": false,
            "sScrollX": true,
            "dom": 'rt',
            "searching": false,
            "sScrollXInner": "1500px",
            "sScrollY": true,
            "paging": false,//不分页
            keys: {
                columns: [7]
            },
            "language": {
                "sProcessing": "处理中...",
                "sLengthMenu": "显示 _MENU_ 项结果",
                "sZeroRecords": "没有匹配结果",
                "sInfo": "显示第 _START_ 至 _END_ 条结果，共 _TOTAL_ 条",
                "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                "sInfoPostFix": "",
                "sSearch": "搜索:",
                "sUrl": "",
                "sEmptyTable": "查询的数据不存在！",
                "sLoadingRecords": "载入中...",
                "sInfoThousands": ",",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "上页",
                    "sNext": "下页",
                    "sLast": "末页"
                },
                "oAria": {
                    "sSortAscending": ": 以升序排列此列",
                    "sSortDescending": ": 以降序排列此列"
                }
            },
            "footerCallback": function (row, data, start, end, display) {
                var api = this.api(), data;
                var intVal = function (i) {
                    return typeof i === 'string' ?
                        i.replace(/[\$,]/g, '') * 1 :
                        typeof i === 'number' ?
                        i : 0;
               };
                pageTotal = api
                    .column(7, { page: 'current' })
                    .data()
                    .reduce(function (a, b) {
                       return intVal(a) + intVal(b);
                    }, 0);

                $(api.column(7).footer()).html(
                    '' + pageTotal + ''
                );
            }
        });
        $("div.toolbar").html("<div>跳转到第<input type='text' style='width:30px;height:20px;margin:0 5px 0 5px;'/>页<span  style='color:#fff;font-size:12px;cursor: pointer;margin-left:10px;padding:2px 3px;' class='btn-primary'>跳转</span><div>");
        $(".dataTables_scrollBody").height($(window).outerHeight() - $(".dataTables_scrollBody").offset().top - $(".tableBottom").outerHeight() - 50 - $(".dataTables_scrollFootInner").outerHeight());
        
        $("#orderForm tbody tr").dblclick(function () {
            PageCommon.ModalOpen({
                id: "Plan",
                title: '借出取消引入查询',
                width: "1000px",
                height: "500px",
                btn: ['添加'],
                url: '/PurchaseSale/LoanCancellationApply/QueryOrderModel',
                callBack: function (iframeId) {
                    PageCommon.ChildrenFrames(iframeId).codeset_vue.Save()
                }
            })
        })
        $('#orderForm').on('key-focus', function (e, datatable, cell, originalEvent) {
            var rowIndex = cell.index().row;
            var rowData = datatable.row(rowIndex).data();
            if (cell.index().column == 7) {
                cell.node().innerHTML = $("#temp_a6").html();
                $("#div_temp_a6").attr("id", "div_temp_a6" + cell.index().row + "_" + cell.index().column);
                //初始化VUE模板
                var cheld = new Vue({
                    el: "#div_temp_a6" + cell.index().row + "_" + cell.index().column,
                    data: {
                        vmodel1: cell.data()
                    }
                });
                //设置控件在DataTables上
                var jqInputs = $('input', cell.node());
                $(jqInputs).attr('id', "input_temp_a6" + cell.index().row + "_" + cell.index().column);
                $(".outer", cell.node()).width(150);
            }
        });

        $('#orderForm').on('key-blur', function (e, datatable, cell, originalEvent) {
            var rowIndex = cell.index().row;
            var rowData = datatable.row(rowIndex).data();
            var jqInputs = null;
            if (cell.index().column == 7) {
                jqInputs = $('input', cell.node())
            }
            //修改datatable 对应的值
            cell.data($(jqInputs[0]).val());
            PageCommon.RefreshTablePage("orderForm")
        });
    });   
        var searchData = {};
        var vmMenu = new Vue({
            el: '#apps',
            data: {
                Menu_Address: '',
                cancelReason:''
            },
            mounted: function () {
            },
            methods: {
                Save: function () {
                },
                Update: function () {
                },
                Submit: function () {
                },
                Audit: function () {
                },
                Search: function () {
                },
                Back: function () {
                    window.location.href = "List";
                },
              
            }
        });
</script>